/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 24179 (\N{CJK UNIFIED IDEOGRAPH-5E73}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 22343 (\N{CJK UNIFIED IDEOGRAPH-5747}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 22870 (\N{CJK UNIFIED IDEOGRAPH-5956}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 21169 (\N{CJK UNIFIED IDEOGRAPH-52B1}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 21464 (\N{CJK UNIFIED IDEOGRAPH-53D8}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 21270 (\N{CJK UNIFIED IDEOGRAPH-5316}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 35757 (\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 32451 (\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 36718 (\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:64: UserWarning: Glyph 25968 (\N{CJK UNIFIED IDEOGRAPH-6570}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/rewards.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 25937 (\N{CJK UNIFIED IDEOGRAPH-6551}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 25588 (\N{CJK UNIFIED IDEOGRAPH-63F4}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 25104 (\N{CJK UNIFIED IDEOGRAPH-6210}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 21151 (\N{CJK UNIFIED IDEOGRAPH-529F}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 29575 (\N{CJK UNIFIED IDEOGRAPH-7387}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 21464 (\N{CJK UNIFIED IDEOGRAPH-53D8}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 21270 (\N{CJK UNIFIED IDEOGRAPH-5316}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 35757 (\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 32451 (\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 36718 (\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:74: UserWarning: Glyph 25968 (\N{CJK UNIFIED IDEOGRAPH-6570}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/success_rates.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 24179 (\N{CJK UNIFIED IDEOGRAPH-5E73}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 22343 (\N{CJK UNIFIED IDEOGRAPH-5747}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 21709 (\N{CJK UNIFIED IDEOGRAPH-54CD}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 24212 (\N{CJK UNIFIED IDEOGRAPH-5E94}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 26102 (\N{CJK UNIFIED IDEOGRAPH-65F6}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 38388 (\N{CJK UNIFIED IDEOGRAPH-95F4}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 21464 (\N{CJK UNIFIED IDEOGRAPH-53D8}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 21270 (\N{CJK UNIFIED IDEOGRAPH-5316}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 35757 (\N{CJK UNIFIED IDEOGRAPH-8BAD}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 32451 (\N{CJK UNIFIED IDEOGRAPH-7EC3}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 36718 (\N{CJK UNIFIED IDEOGRAPH-8F6E}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
/Users/zdk/Downloads/data_structure/train.py:84: UserWarning: Glyph 25968 (\N{CJK UNIFIED IDEOGRAPH-6570}) missing from font(s) Arial.
  plt.savefig(f"{save_path}/response_times.png")
c
[95m[1m======== MARL训练配置 ========[0m
训练轮数: [93m5[0m
每轮步数: [93m20[0m
模型保存: 每[93m1[0m轮
使用的预设灾难规模: [93m中型灾难[0m
网格大小: [93m20x20[0m
救援人员: [93m10[0m名

[94m灾难生成参数:[0m
  • 初始生成概率: [96m0.15[0m
  • 初始灾难数量: [96mNone[0m
  • 最大灾难等级: [96mNone[0m

[94m奖励设置:[0m
  • 完成救援: [92m+10.0[0m
  • 高优先级任务: [92m+任务等级/10[0m
  • 协调避免重复: [92m+2.0[0m
  • 救援进度: [92m+等级减少值[0m
  • 时间惩罚: [91m-0.1/步[0m
[95m[1m================================[0m
使用预设灾难规模: 中型灾难, 网格大小=20, 灾情生成概率=0.15
救援人员数量: 10

[1m▶ 开始MARL训练过程，分三个阶段执行:[0m
  - [93m阶段1 (前1/3):[0m 灾难初期 - 灾情生成概率约[96m0.5[0m，保持至少[96m20[0m个灾情点
  - [93m阶段2 (中间1/3):[0m 灾难中期 - 灾情生成概率约[96m0.3[0m，维持[96m5-20[0m个灾情点
  - [93m阶段3 (最后1/3):[0m 灾难后期 - 灾情生成概率约[96m0.1[0m，不超过[96m5[0m个灾情点
 ([94m训练过程中详细的调试信息已隐藏，只显示关键训练指标[0m)


[1m▶ 开始第 [93m1-5/5[0m [1m轮训练...[0m
[[1m进度 1/5[0m] 平均奖励: [91m-2.00[0m | 成功率: [92m0.00[0m | 平均响应时间: [96m0.00[0m | 探索率: [93m0.90[0m
[[1m进度 2/5[0m] 平均奖励: [91m-2.00[0m | 成功率: [92m0.00[0m | 平均响应时间: [96m0.00[0m | 探索率: [93m0.67[0m
[[1m进度 3/5[0m] 平均奖励: [91m-2.00[0m | 成功率: [92m0.00[0m | 平均响应时间: [96m0.00[0m | 探索率: [93m0.43[0m
[[1m进度 4/5[0m] 平均奖励: [91m-2.00[0m | 成功率: [92m0.00[0m | 平均响应时间: [96m0.00[0m | 探索率: [93m0.19[0m
[[1m进度 5/5[0m] 平均奖励: [91m-2.00[0m | 成功率: [92m0.00[0m | 平均响应时间: [96m0.00[0m | 探索率: [93m0.05[0m

[1m▶ 第5轮奖励统计:[0m
  • 完成任务奖励: [92m0.0[0m (平均 [92m0.00/次[0m)
  • 优先级奖励: [92m0.0[0m (平均 [92m0.00/次[0m)
  • 协调奖励: [92m0.0[0m (平均 [92m0.00/次[0m)
  • 进度奖励: [92m0.0[0m (平均 [92m0.00/次[0m)
  • 时间惩罚: [91m-100.0[0m (平均 [91m-0.10/次[0m)

模型已保存到 ./models/marl_model.pt
训练结果可视化已保存到: ./training_results

[95m[1m======== MARL训练完成 ========[0m
[1m最终模型性能:[0m
  • 平均奖励: [91m-2.00[0m
  • 救援成功率: [92m0.00[0m
  • 平均响应时间: [96m0.00[0m
模型已保存到: [93m./models/marl_model.pt[0m
[95m[1m================================[0m

